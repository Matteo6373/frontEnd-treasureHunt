<div class="card h-100 shadow border-0 rounded-4 overflow-hidden hover-scale"
     [style.backgroundImage]="'url(' + (treasure.theme | themeImage) + ')'"
     style="background-size: cover; background-position: center; transition: transform 0.3s;"
     id="card-{{ treasure.id }}">

  <!-- Overlay semi-trasparente -->
  <div class="card-overlay d-flex flex-column justify-content-between h-100 p-3 bg-dark bg-opacity-25">

    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-2">
      <h5 class="card-title text-white mb-0">{{ treasure.theme }}</h5>
    </div>

    <!-- Body -->
    <div class="card-body p-0">
      <p class="card-text fst-italic text-white bg-dark bg-opacity-50 p-2 rounded">
        {{ treasure.hint }}
      </p>

      <!-- Pulsanti per aggiungere, generare o cancellare indizi -->
      <div class="d-flex gap-2 mt-2 mb-3">
        <button class="btn btn-sm btn-primary" (click)="createClue(treasure)">
          Crea Indizio
        </button>
        <button class="btn btn-sm btn-success" (click)="generateCluesAI(treasure)">
          Genera Indizi AI
        </button>
        <button class="btn btn-sm btn-danger" (click)="deleteTreasure(treasure)">
          Cancella Caccia
        </button>
      </div>


      <ul
        cdkDropList
        [cdkDropListData]="treasure.clues"
        (cdkDropListDropped)="dropClue($event)"
        class="list-group rounded-4 overflow-hidden mt-3 clue-glass-ultra"
      >
        @for (clue of treasure.clues; track clue.id) {
          <li
            class="list-group-item clue-item-ultra"
            cdkDrag
            cdkDragBoundary="#card-{{ treasure.id }}"
          >
            {{ clue.text }}
          </li>
        }

        @empty {
          <li class="list-group-item text-muted fst-italic text-center">
            Nessun indizio disponibile
          </li>
        }
      </ul>
    </div>

  </div>
</div>
